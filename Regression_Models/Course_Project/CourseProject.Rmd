---
title: "Automatic or Manual Transmissions - Which is best?"
author: "Sean Clarke"
date: "17 August 2015"
output: html_document
---

```{r cache = F, echo = F, message = F, warning = F, tidy = F, results='hide'}
# Setup data and libraries
data("mtcars")
library(ggplot2)
library(GGally)
library(dplyr)

mtcars <- mutate(mtcars, cyl = factor(cyl)) # convert cyl to a factor
mtcars <- mutate(mtcars, vs = factor(vs)) # convert cyl to a factor
mtcars <- mutate(mtcars, am = factor(am)) # convert cyl to a factor
mtcars <- mutate(mtcars, gear = factor(gear)) # convert cyl to a factor
```

## Exploratory Data Analysis

As a means of gathering as much information as possible in a dense fashion for our exploratory analysis, we make a ggpairs plot (see plot 1). 

The boxplots for the categorical variables suggest that the fuel consumption is strongly dependent on the number of cylinders, vs (V vs Straight engine) and the type of transmission. There is no clear dependency on fuel consumption and the number of gears.

From the calculated correlation values for the continuous variables, we see some positive correlation between fuel consumption and the rear axel ratio and 1/4 mile time. We see strong negative correlation between fuel consumption and Displacement, Horsepower, and weight. There is a weaker negative correlation between fuel consumption and the number of carburetors.

Interestingly (and maybe not surprisingly) fuel consumtions appears to depend in almost all the other factors!

# Model Selection

In order to find the optimal fit, we proceed to fit nested models, we will then proceed to evaluate an ANOVA for these fits and use the output of the F-Test to identify the necessary terms.

```{r}
fit1 <- lm(mpg ~  am , mtcars)
fit2 <- lm(mpg ~ am + wt, mtcars)
fit3 <- lm(mpg ~ am + wt + disp, mtcars)
fit4 <- lm(mpg ~ am + wt + disp + cyl, mtcars)
fit5 <- lm(mpg ~ am + wt + disp + cyl + drat, mtcars)
fit6 <- lm(mpg ~ am + wt + disp + cyl + drat + qsec, mtcars)
fit7 <- lm(mpg ~ am + wt + disp + cyl + drat + qsec + vs, mtcars)
fit8 <- lm(mpg ~ am + wt + disp + cyl + drat + qsec + vs + gear, mtcars)
fit9 <- lm(mpg ~ am + wt + disp + cyl + drat + qsec + vs + gear + carb, mtcars)
fit10 <- lm(mpg ~ am + wt + disp + cyl + drat + qsec + vs + gear + carb + hp, mtcars)
anova(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8, fit9, fit10)
```

```{r}
fit1 <- lm(mpg ~  am , mtcars)
fit2 <- lm(mpg ~  am + wt + hp , mtcars)
fit3 <- lm(mpg ~  am + wt + hp + cyl + disp , mtcars)
fit4  <- lm(mpg ~  am + wt + hp + cyl + disp + gear + carb , mtcars)
fit5  <- lm(mpg ~  am + wt + hp + cyl + disp + gear + carb + vs + qsec , mtcars)
anova(fit1, fit2, fit3, fit4, fit5 )
```

```{r}
fit1 <- lm(mpg ~  am , mtcars)
fit2 <- lm(mpg ~  am + wt + hp , mtcars)
fit3 <- lm(mpg ~  am + wt + hp + cyl + disp , mtcars)
fit4  <- lm(mpg ~  am + wt + hp + cyl + disp + gear + carb , mtcars)
fit5  <- lm(mpg ~  am + wt + hp + cyl + disp + gear + carb + vs + qsec , mtcars)
anova(fit1, fit2, fit3, fit4, fit5 )
```

# Appendix - Plots

```{r cache=TRUE, fig.width=10, fig.height=8, echo = F, message = F, warning = F, tidy = F, results='hide'}
require(GGally); require(ggplot2)
g = ggpairs(mtcars, lower = list(continuous = "smooth"),params = c(method = "loess"), title="Plot 1 - ggpairs plot for mtcars dataset to investigate dependencies")
g
```


